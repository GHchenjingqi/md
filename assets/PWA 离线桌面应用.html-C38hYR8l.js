import{_ as l,c,d as a,a as t,b as o,e as s,w as e,r as i,o as u}from"./app-CsUEYrmK.js";const r={},k={id:"二、实现一个pwa",tabindex:"-1"},d={class:"header-anchor",href:"#二、实现一个pwa"},v={id:"_1-创建manifest文件",tabindex:"-1"},m={class:"header-anchor",href:"#_1-创建manifest文件"},g={id:"_2-引入service-worker-服务工作者",tabindex:"-1"},b={class:"header-anchor",href:"#_2-引入service-worker-服务工作者"};function q(y,n){const p=i("font");return u(),c("div",null,[n[39]||(n[39]=a("h3",{id:"一、pwa介绍",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#一、pwa介绍"},[a("span",null,"一、PWA介绍")])],-1)),a("p",null,[n[6]||(n[6]=s("PWA，全称为**",-1)),t(p,{style:{color:"#2F4BDA"}},{default:e(()=>n[0]||(n[0]=[s("Progressive",-1)])),_:1,__:[0]}),n[7]||(n[7]=s("** Web App （渐进式web应用），是谷歌推出的一种运用现代Web技术实现的用户体验接近原生应用的Web应用程序。",-1)),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[1]||(n[1]=[s("像应用一样安装在用户的设备上，并且支持",-1)])),_:1,__:[1]}),a("strong",null,[t(p,{style:{color:"#DF2A3F"}},{default:e(()=>n[2]||(n[2]=[s("离线访问",-1)])),_:1,__:[2]}),n[4]||(n[4]=s("****",-1)),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[3]||(n[3]=[s("、推送通知",-1)])),_:1,__:[3]})]),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[5]||(n[5]=[s("等功能。",-1)])),_:1,__:[5]})]),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[8]||(n[8]=[s("官方文档地址：",-1)])),_:1,__:[8]}),n[40]||(n[40]=a("a",{href:"https://web.developers.google.cn/patterns/web-apps?hl=zh-cn",target:"_blank",rel:"noopener noreferrer"},"https://web.developers.google.cn/patterns/web-apps?hl=zh-cn",-1)),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[9]||(n[9]=[s("网站+PWA技术，可以实现离线时打开软件的效果。网站通过秒级安装到客户端，加载浏览器缓存实现类似原生应用的体验。",-1)])),_:1,__:[9]}),t(p,{style:{color:"rgb(44, 44, 54)"}}),n[41]||(n[41]=a("p",null,[a("img",{src:"https://cdn.nlark.com/yuque/0/2025/png/1460947/1751524831426-113a2bd8-8c17-44ff-bb7f-2d333a58615f.png",alt:""})],-1)),n[42]||(n[42]=a("p",null,[a("strong",null,"特点"),s("：")],-1)),n[43]||(n[43]=a("p",null,"1.打开web时，地址栏出现安装应用图标，点击会直接安装到设备",-1)),n[44]||(n[44]=a("p",null,"2.控制台应用里的service workers 会显示已注册",-1)),n[45]||(n[45]=a("p",null,"3.控制台缓存里存在离线缓存数据",-1)),n[46]||(n[46]=a("p",null,[a("img",{src:"https://cdn.nlark.com/yuque/0/2025/png/1460947/1751524991842-c9b50e03-0435-45ba-9642-ae2e7932515f.png",alt:""})],-1)),a("p",null,[a("strong",null,[t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[10]||(n[10]=[s("优点",-1)])),_:1,__:[10]})]),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[11]||(n[11]=[s("：",-1)])),_:1,__:[11]})]),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[12]||(n[12]=[s("1.跨平台兼容性强，一套web代码多端兼容；",-1)])),_:1,__:[12]}),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[13]||(n[13]=[s("2.无需安装，节省空间，比electron体积小的多；",-1)])),_:1,__:[13]}),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[14]||(n[14]=[s("3.免上架应用市场，免平台税；",-1)])),_:1,__:[14]}),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[15]||(n[15]=[s("4.离线访问，没有网络也可以使用。",-1)])),_:1,__:[15]}),a("p",null,[a("strong",null,[t(p,{style:{color:"rgb(44, 44, 54)"}})])]),a("p",null,[a("strong",null,[t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[16]||(n[16]=[s("缺点：",-1)])),_:1,__:[16]})])]),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[17]||(n[17]=[s("1.功能限制，web应用对硬件访问蓝牙/nfc有缺陷。",-1)])),_:1,__:[17]}),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[18]||(n[18]=[s("2.网络依赖，首次打开必须有网络条件；",-1)])),_:1,__:[18]}),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[19]||(n[19]=[s("3.无应用市场，曝光量不足。",-1)])),_:1,__:[19]}),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[20]||(n[20]=[s("4.性能不足，不如原生应用。",-1)])),_:1,__:[20]}),t(p,{style:{color:"rgb(44, 44, 54)"}}),a("h3",k,[a("a",d,[a("span",null,[t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[21]||(n[21]=[s("二、实现一个PWA",-1)])),_:1,__:[21]})])])]),a("h4",v,[a("a",m,[a("span",null,[n[23]||(n[23]=s("1.创建",-1)),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[22]||(n[22]=[s("Manifest文件",-1)])),_:1,__:[22]})])])]),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[24]||(n[24]=[s("Web应用元数据的一个JSON文件，包括应用名称、图标、开始URL等信息。",-1)])),_:1,__:[24]}),n[47]||(n[47]=o(`<div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My PWA Application&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 应用的名字，会在添加到主屏幕时显示</span></span>
<span class="line">  <span class="token property">&quot;short_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PWA&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 短名字，在空间有限时使用</span></span>
<span class="line">  <span class="token property">&quot;start_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 启动路径，默认是当前目录</span></span>
<span class="line">  <span class="token property">&quot;display&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standalone&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 显示模式：fullscreen, standalone, minimal-ui, browser</span></span>
<span class="line">  <span class="token property">&quot;background_color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 背景颜色，在启动画面和浏览器UI中使用</span></span>
<span class="line">  <span class="token property">&quot;theme_color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#0000ff&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 主题颜色，通常用于浏览器的地址栏或工具栏</span></span>
<span class="line">  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;An example Progressive Web App.&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 应用描述</span></span>
<span class="line">  <span class="token property">&quot;icons&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/icons/icon-192x192.png&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 图标路径</span></span>
<span class="line">      <span class="token property">&quot;sizes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192x192&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 图标尺寸</span></span>
<span class="line">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span>  <span class="token comment">// MIME类型</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/images/icons/icon-512x512.png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;sizes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;512x512&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;orientation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;any&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 屏幕方向：any, natural, landscape, landscape-primary, landscape-secondary, portrait, portrait-primary, portrait-secondary</span></span>
<span class="line">  <span class="token property">&quot;scope&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 定义应用的范围，即哪些页面可以被视为PWA的一部分</span></span>
<span class="line">  <span class="token property">&quot;lang&quot;</span><span class="token operator">:</span> <span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 应用的语言环境</span></span>
<span class="line">  <span class="token property">&quot;dir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ltr&quot;</span><span class="token punctuation">,</span>  <span class="token comment">// 文本的方向：ltr（从左到右），rtl（从右到左）</span></span>
<span class="line">  <span class="token property">&quot;related_applications&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 相关的原生应用程序列表</span></span>
<span class="line">  <span class="token property">&quot;prefer_related_applications&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>  <span class="token comment">// 是否优先使用相关的原生应用</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基础版：</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;My PWA Application&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;short_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PWA&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;start_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;display&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fullscreen&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;background_color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;An example Progressive Web App.&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;theme_color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;#000000&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;icons&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;icons/manifest-icon-192.maskable.png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;sizes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192x192&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;purpose&quot;</span><span class="token operator">:</span> <span class="token string">&quot;maskable any&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;icons/manifest-icon-192.maskable.png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;sizes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192x192&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;purpose&quot;</span><span class="token operator">:</span> <span class="token string">&quot;maskable any&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;icons/manifest-icon-512.maskable.png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;sizes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;512x512&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;purpose&quot;</span><span class="token operator">:</span> <span class="token string">&quot;maskable any&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;src&quot;</span><span class="token operator">:</span> <span class="token string">&quot;icons/manifest-icon-512.maskable.png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;sizes&quot;</span><span class="token operator">:</span> <span class="token string">&quot;512x512&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;purpose&quot;</span><span class="token operator">:</span> <span class="token string">&quot;maskable any&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>icons图标可以使用pwa-asset-generator（<a href="https://github.com/elegantapp/pwa-asset-generator" target="_blank" rel="noopener noreferrer">https://github.com/elegantapp/pwa-asset-generator</a>） 插件生成，再从终端拷贝icon集合</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">// 安装</span>
<span class="line"><span class="token function">npm</span> <span class="token function">install</span> pwa-asset-generator</span>
<span class="line">// 执行,将logo.png处理为不同分辨率并拷贝到icons里面</span>
<span class="line">npx pwa-asset-generator logo.png icons</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在html的head引入mainfest.json</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html"><pre><code><span class="line"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>manifest<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>manifest.json<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7)),a("h4",g,[a("a",b,[a("span",null,[t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[25]||(n[25]=[s("2.引入service worker 服务工作者",-1)])),_:1,__:[25]})])])]),a("p",null,[n[27]||(n[27]=s("可以使用下面的文件，也可以使用第三方服务工作者库**",-1)),t(p,{style:{color:"rgb(44, 44, 54)"}},{default:e(()=>n[26]||(n[26]=[s("Workbox ",-1)])),_:1,__:[26]}),n[28]||(n[28]=s("**",-1))]),n[48]||(n[48]=o(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 离线缓存名称</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token constant">CACHE_NAME</span> <span class="token operator">=</span> <span class="token string">&#39;my-app-cache-v1&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 离线缓存的文件</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token constant">ASSETS_TO_CACHE</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;/index.html&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;/styles/main.css&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;/scripts/main.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;/images/logo.png&#39;</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 配置：决定使用网络优先还是缓存优先策略</span></span>
<span class="line"><span class="token keyword">const</span> cacheStrategy <span class="token operator">=</span> <span class="token string">&#39;network-first&#39;</span> <span class="token comment">// 或者 &#39;cache-first&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 安装阶段：缓存必要的资源</span></span>
<span class="line">self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;install&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;[Service Worker] Installing...&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span></span>
<span class="line">    caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token constant">CACHE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cache</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token constant">ASSETS_TO_CACHE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  self<span class="token punctuation">.</span><span class="token function">skipWaiting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 强制激活新版本</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 激活阶段：清理旧缓存</span></span>
<span class="line">self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;activate&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;[Service Worker] Activating...&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span></span>
<span class="line">    caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">keys</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span></span>
<span class="line">        keys<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> key <span class="token operator">!==</span> <span class="token constant">CACHE_NAME</span><span class="token punctuation">)</span></span>
<span class="line">          <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  self<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 立即控制所有页面</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 请求拦截：使用缓存策略响应请求</span></span>
<span class="line">self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;fetch&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> request <span class="token punctuation">}</span> <span class="token operator">=</span> event<span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>method <span class="token operator">!==</span> <span class="token string">&#39;GET&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="line">  event<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheStrategy <span class="token operator">===</span> <span class="token string">&#39;network-first&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// 尝试从网络获取最新内容，失败后使用缓存</span></span>
<span class="line">      <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> responseFromNetwork <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">return</span> responseFromNetwork<span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">const</span> responseFromCache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>responseFromCache<span class="token punctuation">)</span> <span class="token keyword">return</span> responseFromCache<span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>destination <span class="token operator">===</span> <span class="token string">&#39;document&#39;</span><span class="token punctuation">)</span> <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheStrategy <span class="token operator">===</span> <span class="token string">&#39;cache-first&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// 先尝试从缓存中获取，如果不存在则从网络获取</span></span>
<span class="line">      <span class="token keyword">const</span> responseFromCache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token keyword">return</span> responseFromCache <span class="token operator">||</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-主页面加载sw" tabindex="-1"><a class="header-anchor" href="#_3-主页面加载sw"><span>3.主页面加载sw</span></a></h4><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&#39;serviceWorker&#39;</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;load&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&#39;/service-worker.js&#39;</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">registration</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Service Worker registered:&#39;</span><span class="token punctuation">,</span> registration<span class="token punctuation">.</span>scope<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Service Worker registration failed:&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3)),a("p",null,[n[30]||(n[30]=s("demo地址：",-1)),n[31]||(n[31]=a("a",{href:"https://github.com/GHchenjingqi/PWA",target:"_blank",rel:"noopener noreferrer"},"https://github.com/GHchenjingqi/PWA",-1)),n[32]||(n[32]=s("，其他更深入用法，比如分享**",-1)),t(p,{style:{color:"rgb(55, 71, 79)","background-color":"rgb(241, 243, 244)"}},{default:e(()=>n[29]||(n[29]=[s("navigator.share()。",-1)])),_:1,__:[29]}),n[33]||(n[33]=s("**",-1))]),a("p",null,[n[35]||(n[35]=s("归根结底依旧是通过js调用 ",-1)),a("strong",null,[t(p,{style:{color:"#601BDE"}},{default:e(()=>n[34]||(n[34]=[s("navigator",-1)])),_:1,__:[34]})]),n[36]||(n[36]=s(" 对象(",-1)),n[37]||(n[37]=a("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Navigator",target:"_blank",rel:"noopener noreferrer"},"https://developer.mozilla.org/en-US/docs/Web/API/Navigator",-1)),n[38]||(n[38]=s(")的可用API实现应用的功能。",-1))]),n[49]||(n[49]=o(`<div class="language-plain line-numbers-mode" data-highlighter="prismjs" data-ext="plain"><pre><code><span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="https://cdn.nlark.com/yuque/0/2025/png/1460947/1751530051708-64f156e4-8b4c-47fe-8384-249646aa95d2.png" alt=""></p>`,2))])}const w=l(r,[["render",q]]),h=JSON.parse('{"path":"/mds/PWA%20%E7%A6%BB%E7%BA%BF%E6%A1%8C%E9%9D%A2%E5%BA%94%E7%94%A8.html","title":"","lang":"en-US","frontmatter":{},"headers":[{"level":3,"title":"一、PWA介绍","slug":"一、pwa介绍","link":"#一、pwa介绍","children":[]},{"level":3,"title":"二、实现一个PWA","slug":"二、实现一个pwa","link":"#二、实现一个pwa","children":[]}],"git":{},"filePathRelative":"mds/PWA 离线桌面应用.md","excerpt":"<h3>一、PWA介绍</h3>\\n<p>PWA，全称为**** Web App （渐进式web应用），是谷歌推出的一种运用现代Web技术实现的用户体验接近原生应用的Web应用程序。<strong>****</strong></p>\\n<a href=\\"https://web.developers.google.cn/patterns/web-apps?hl=zh-cn\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://web.developers.google.cn/patterns/web-apps?hl=zh-cn</a><p><img src=\\"https://cdn.nlark.com/yuque/0/2025/png/1460947/1751524831426-113a2bd8-8c17-44ff-bb7f-2d333a58615f.png\\" alt=\\"\\"></p>"}');export{w as comp,h as data};
